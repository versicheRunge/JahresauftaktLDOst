<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktive Bingo-Karte</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #f4f4f9, #e0e0e0);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            animation: backgroundAnimation 10s infinite alternate;
        }

        @keyframes backgroundAnimation {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .bingo-card {
            width: 90%;
            max-width: 800px;
            background-color: #ffffff;
            border: 5px solid #00a859;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .bingo-header {
            background-color: #00a859;
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 24px;
            font-weight: bold;
        }

        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            padding: 10px;
        }

        .bingo-cell {
            background-color: #f9f9f9;
            color: #333;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            padding: 20px;
            border: 2px solid #00a859;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .bingo-cell.completed {
            background: linear-gradient(135deg, gold, #ffd700);
            color: white;
            transform: rotateY(360deg);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .bingo-cell.completed::after {
            content: "‚úîÔ∏è";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #00a859;
            animation: pop 0.5s ease;
        }

        .bingo-cell.completed .date-stamp {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 10px;
            color: #00a859;
        }

        .bingo-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(0, 168, 89, 0.5);
        }

        .bingo-cell.rotate {
            animation: rotate 0.5s ease-in-out;
        }

        @keyframes rotate {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        @keyframes pop {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .bingo-footer {
            text-align: center;
            padding: 15px;
            font-size: 16px;
            color: #333;
            background-color: #f1f1f1;
            border-top: 2px solid #00a859;
        }

        .progress {
            margin-top: 10px;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-bar-fill {
            height: 100%;
            background-color: #00a859;
            width: 0%;
            transition: width 0.5s ease;
        }

        .buttons {
            margin-top: 10px;
        }

        button {
            margin: 5px;
            padding: 10px 15px;
            font-size: 14px;
            background-color: #00a859;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #008c47;
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 1;
            transition: opacity 1s ease;
        }

        .confetti.fade-out {
            opacity: 0;
        }

        .motivational {
            margin-top: 10px;
            font-size: 18px;
            color: #00a859;
            font-weight: bold;
        }

        .success-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            text-align: center;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .success-overlay.active {
            display: flex;
        }

        .success-overlay h1 {
            font-size: 36px;
            margin-bottom: 20px;
        }

        .success-overlay button {
            padding: 10px 20px;
            font-size: 18px;
        }

        .green-checkmark {
            font-size: 60px;
            color: #00a859;
        }

        @keyframes fall {
            0% { transform: translateY(-100vh) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        .firework {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
        }

        .firework-particle {
            position: absolute;
            width: 5px;
            height: 5px;
            background-color: gold;
            border-radius: 50%;
            animation: explode 1s ease-out;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(10); opacity: 0; }
        }

        .easter-egg {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #00a859;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 10001;
            text-align: center;
        }

        .easter-egg.active {
            display: block;
        }

        .t-frame {
            position: absolute;
            border: 3px solid black;
            border-radius: 10px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0% { border-color: black; }
            50% { border-color: gold; }
            100% { border-color: black; }
        }

        .detective-emoji {
            position: absolute;
            font-size: 24px;
            animation: float 3s infinite;
        }

        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0); }
        }

        .email-overlay {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 10002;
        }

        .email-overlay.active {
            display: block;
        }

        #lauftext {
            white-space: nowrap;
            overflow: hidden;
            box-sizing: border-box;
            width: 100%;
            color: #ff0000;
            font-size: 24px;
            cursor: pointer;
            margin: 20px 0;
            animation: lauftext 10s linear infinite;
        }

        @keyframes lauftext {
            from { transform: translateX(100%); }
            to { transform: translateX(-100%); }
        }

        .orientation-warning {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            text-align: center;
            justify-content: center;
            align-items: center;
            z-index: 10003;
            font-size: 24px;
            padding: 20px;
        }

        .orientation-warning.active {
            display: flex;
        }
    </style>
</head>
<body>

<div class="orientation-warning" id="orientationWarning">
    Bitte drehen Sie Ihr Ger√§t ins Querformat f√ºr die beste Darstellung.
</div>

<div class="bingo-card">
    <div class="bingo-header">Interaktive Bingo-Challenge</div>
    <div class="bingo-grid" id="bingoGrid">
        <div class="bingo-cell">50 x Verl√§ngerungen</div>
        <div class="bingo-cell">2 x K11</div>
        <div class="bingo-cell">2.500 ‚Ç¨ Unfall (neu)</div>
        <div class="bingo-cell">300.000 LV-Beitragssumme gesamt</div>
        <div class="bingo-cell">4 x KTG</div>
        <div class="bingo-cell">2 x R√ºrup</div>
        <div class="bingo-cell">10 x ItzeTipp</div>
        <div class="bingo-cell">50 x Verl√§ngerungen</div>
        <div class="bingo-cell">2 x K11</div>
        <div class="bingo-cell">2.500 ‚Ç¨ Unfall (neu)</div>
        <div class="bingo-cell">2 x Gothaer (neu)</div>
        <div class="bingo-cell">2 x R√ºrup</div>
        <div class="bingo-cell">2 x Riester (neu)</div>
        <div class="bingo-cell">10 x ItzeTipp</div>
        <div class="bingo-cell">50 x Verl√§ngerungen</div>
        <div class="bingo-cell">2 x Risiko LV</div>
        <div class="bingo-cell">25 x AG Daten</div>
        <div class="bingo-cell">5 x Alte Leipziger</div>
        <div class="bingo-cell">2.500 ‚Ç¨ Unfall (neu)</div>
        <div class="bingo-cell">5 x SBU</div>
        <div class="bingo-cell">5 x RS (neu)</div>
        <div class="bingo-cell">50 x Verl√§ngerungen</div>
        <div class="bingo-cell">2 x Risiko LV</div>
        <div class="bingo-cell">5 x Alte Leipziger</div>
        <div class="bingo-cell">2.500 ‚Ç¨ Unfall (neu)</div>
        <div class="bingo-cell">4 x SBU</div>
        <div class="bingo-cell">20.000 ‚Ç¨ AP seit 01.01.</div>
        <div class="bingo-cell">5 x RS (neu)</div>
        <div class="bingo-cell">2 x R√ºrup</div>
        <div class="bingo-cell">2 x Risiko LV</div>
    </div>
    <div class="bingo-footer">
        <div id="progress" class="progress">Erledigte Felder: 0 von 20</div>
        <div class="progress-bar">
            <div id="progressBarFill" class="progress-bar-fill"></div>
        </div>
        <div id="motivational" class="motivational"></div>
        <div class="buttons">
            <button onclick="exportProgress()">Fortschritt speichern</button>
            <button onclick="importProgress()">Fortschritt laden</button>
            <button onclick="resetProgress()">Zur√ºcksetzen</button>
        </div>
    </div>
</div>

<div class="confetti" id="confetti"></div>
<div class="firework" id="firework"></div>
<div class="success-overlay" id="successOverlay">
    <div>
        <h1>Gl√ºckwunsch! Ziel erreicht!</h1>
        <div class="green-checkmark">‚úîÔ∏è</div>
        <div id="lauftext">F√ºhrungskraft informieren</div>
        <button onclick="closeSuccessOverlay()">Schlie√üen</button>
    </div>
</div>

<div class="email-overlay" id="emailOverlay">
    <h2>E-Mail senden</h2>
    <button onclick="sendEmail()">E-Mail senden</button>
    <button onclick="closeEmailOverlay()">Schlie√üen</button>
</div>

<div class="easter-egg" id="easterEgg">
    üïµÔ∏è‚Äç‚ôÇÔ∏è Du hast das geheime T von Thomas entdeckt ‚Äì wie hast du das geschafft? üïµÔ∏è‚Äç‚ôÇÔ∏è
</div>

<script>
    const cells = document.querySelectorAll('.bingo-cell');
    const progressText = document.getElementById('progress');
    const progressBarFill = document.getElementById('progressBarFill');
    const motivationalText = document.getElementById('motivational');
    const confettiContainer = document.getElementById('confetti');
    const fireworkContainer = document.getElementById('firework');
    const successOverlay = document.getElementById('successOverlay');
    const emailOverlay = document.getElementById('emailOverlay');
    const easterEgg = document.getElementById('easterEgg');
    const orientationWarning = document.getElementById('orientationWarning');
    let completedCount = 0;
    let clicksToday = 0;
    let currentDay = 1;
    let limitDisabled = false;
    let tDiscovered = false;

    // Definition des "T": Obere erste Reihe (0, 1, 2, 3, 4) + Senkrechter Strich ab der Mitte (2, 7, 12, 17, 22)
    const tPattern = [0, 1, 2, 3, 4, 7, 12, 17, 22];

    const motivationalMessages = [
        "Super Start! Du bist ein Bingo-Rockstar!",
        "Halbzeit! Zeit f√ºr eine Tanzpause!",
        "Nur noch wenige Felder ‚Äì du hast das Brett fast gebrochen!",
        "Wow, du bist schneller als ein Flitzebogen!",
        "Ein Feld erledigt, tausend High-Fives f√ºr dich!",
        "Du bist besser als ein 6er im Lotto!",
        "Weiter so! Du bist ein Bingo-Genie!",
        "Nur noch ein paar Klicks ‚Äì du schaffst das!",
        "Du bist auf dem besten Weg zum Bingo-Champion!",
        "Ein Feld nach dem anderen ‚Äì du bist unaufhaltsam!",
        "Wow, du bist hei√üer als eine Chilischote!",
        "Du rockst diese Karte wie ein Profi!",
        "Nur noch ein paar Felder ‚Äì halte durch, Superstar!",
        "Du bist schneller als ein Rennwagen!",
        "Ein Feld geschafft ‚Äì Zeit f√ºr eine Mini-Party!",
        "Du bist besser als ein Kaffee am Morgen!",
        "Wow, du bist ein Bingo-Ninja!",
        "Nur noch ein paar Klicks ‚Äì du bist fast da!",
        "Du bist ein echter Bingo-Zauberer!",
        "Gl√ºckwunsch! Du hast es geschafft ‚Äì du bist der Boss!"
    ];

    // Funktion zur √úberpr√ºfung, ob es sich um ein Mobilger√§t handelt
    function isMobileDevice() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    // Funktion zur √úberpr√ºfung der Bildschirmausrichtung
    function checkOrientation() {
        if (isMobileDevice() && window.innerHeight > window.innerWidth) {
            orientationWarning.classList.add('active');
        } else {
            orientationWarning.classList.remove('active');
        }
    }

    // Event-Listener f√ºr √Ñnderungen der Bildschirmausrichtung
    window.addEventListener('resize', checkOrientation);
    window.addEventListener('orientationchange', checkOrientation);

    // Initiale √úberpr√ºfung der Ausrichtung
    checkOrientation();

    // Tastenk√ºrzel zur Aufhebung der Limitierung (Strg + Shift + L)
    document.addEventListener('keydown', (event) => {
        if (event.ctrlKey && event.shiftKey && event.key === 'L') {
            limitDisabled = !limitDisabled;
            alert(`Limitierung ist jetzt ${limitDisabled ? 'deaktiviert' : 'aktiviert'}.`);
        }
    });

    // Funktion zur √úberpr√ºfung des t√§glichen Limits
    function checkDailyLimit() {
        if (limitDisabled) return true;

        const today = new Date().toLocaleDateString();
        const lastClickDate = localStorage.getItem('lastClickDate');

        if (lastClickDate === today) {
            clicksToday++;
        } else {
            localStorage.setItem('lastClickDate', today);
            clicksToday = 1; // Erster Klick des Tages
        }

        // Tag 1: Maximal 3 Felder, ab Tag 2: unbegrenzt
        const maxClicks = currentDay === 1 ? 3 : Infinity;

        if (clicksToday > maxClicks) {
            alert(`Mehr als ${maxClicks} Felder an einem Tag? Damit haben wir nicht gerechnet, sorry. Morgen kannst du wieder mehr Felder erledigen!`);
            return false;
        }
        return true;
    }

    function createConfetti() {
        for (let i = 0; i < 150; i++) {
            const confetti = document.createElement('div');
            confetti.style.position = 'absolute';
            confetti.style.width = '8px';
            confetti.style.height = '8px';
            confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
            confetti.style.top = `${Math.random() * 100}%`;
            confetti.style.left = `${Math.random() * 100}%`;
            confetti.style.animation = `fall ${Math.random() * 3 + 2}s linear infinite`;
            confetti.style.opacity = '0.7';
            confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
            confettiContainer.appendChild(confetti);
        }
        setTimeout(() => {
            confettiContainer.classList.add('fade-out');
            setTimeout(() => {
                confettiContainer.innerHTML = '';
                confettiContainer.classList.remove('fade-out');
            }, 1000);
        }, 5000);
    }

    function createFirework() {
        for (let i = 0; i < 50; i++) {
            const particle = document.createElement('div');
            particle.className = 'firework-particle';
            particle.style.top = `${Math.random() * 100}%`;
            particle.style.left = `${Math.random() * 100}%`;
            fireworkContainer.appendChild(particle);
        }
        setTimeout(() => {
            fireworkContainer.innerHTML = '';
        }, 1000);
    }

    function checkEasterEgg() {
        if (tDiscovered) return; // Wenn das "T" bereits entdeckt wurde, nichts tun

        const isTPattern = tPattern.every(index => cells[index].classList.contains('completed'));
        if (isTPattern) {
            tDiscovered = true; // Markiere das "T" als entdeckt
            easterEgg.classList.add('active');
            tPattern.forEach(index => {
                const cell = cells[index];
                const frame = document.createElement('div');
                frame.className = 't-frame';
                frame.style.width = `${cell.offsetWidth}px`;
                frame.style.height = `${cell.offsetHeight}px`;
                frame.style.top = `${cell.offsetTop}px`;
                frame.style.left = `${cell.offsetLeft}px`;
                document.body.appendChild(frame);
            });

            setTimeout(() => {
                easterEgg.classList.remove('active');
                document.querySelectorAll('.t-frame').forEach(el => el.remove());
            }, 5000);
        }
    }

    function loadProgress() {
        const savedProgress = JSON.parse(localStorage.getItem('bingoProgress')) || [];
        cells.forEach((cell, index) => {
            if (savedProgress.includes(index)) {
                cell.classList.add('completed');
                completedCount++;
                const dateStamp = document.createElement('div');
                dateStamp.className = 'date-stamp';
                dateStamp.textContent = `Erledigt am ${new Date().toLocaleDateString()}`;
                cell.appendChild(dateStamp);
            }
        });
        updateProgress();
    }

    function saveProgress() {
        const progress = [];
        cells.forEach((cell, index) => {
            if (cell.classList.contains('completed')) {
                progress.push(index);
            }
        });
        localStorage.setItem('bingoProgress', JSON.stringify(progress));
    }

    function updateProgress() {
        progressText.textContent = `Erledigte Felder: ${completedCount} von 20`;
        progressBarFill.style.width = `${(completedCount / 20) * 100}%`;

        if (completedCount === 19) {
            motivationalText.textContent = "Nur noch ein Feld bis zum Ziel!";
        } else if (completedCount < 20) {
            const messageIndex = Math.floor((completedCount / 20) * motivationalMessages.length);
            motivationalText.textContent = motivationalMessages[messageIndex];
        } else if (completedCount === 20) {
            showSuccessOverlay();
            emailOverlay.classList.add('active');
        }
    }

    function showSuccessOverlay() {
        successOverlay.classList.add('active');
        createConfetti();
        createFirework();

        const lauftext = document.getElementById('lauftext');
        lauftext.addEventListener('click', () => {
            const subject = "Bingo-Challenge abgeschlossen!";
            const body = "Hallo Thomas,\n\nich habe alle Felder der Bingo-Challenge geschafft! üéâ\n\nViele Gr√º√üe,\n[Dein Name]";
            window.location.href = `mailto:thomas.runge@itzehoer.de?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        });
    }

    function closeSuccessOverlay() {
        successOverlay.classList.remove('active');
        confettiContainer.innerHTML = '';
        fireworkContainer.innerHTML = '';
    }

    function closeEmailOverlay() {
        emailOverlay.classList.remove('active');
    }

    function sendEmail() {
        const subject = "Bingo-Challenge abgeschlossen!";
        const body = "Hallo Thomas,\n\nich habe alle Felder der Bingo-Challenge geschafft! üéâ\n\nViele Gr√º√üe,\n[Dein Name]";
        window.location.href = `mailto:thomas.runge@itzehoer.de?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }

    cells.forEach((cell, index) => {
        cell.addEventListener('click', () => {
            if (!cell.classList.contains('completed') && checkDailyLimit()) {
                cell.classList.add('rotate');
                setTimeout(() => {
                    cell.classList.remove('rotate');
                    cell.classList.add('completed');
                    completedCount++; // Z√§hler erh√∂hen
                    const dateStamp = document.createElement('div');
                    dateStamp.className = 'date-stamp';
                    dateStamp.textContent = `Erledigt am ${new Date().toLocaleDateString()}`;
                    cell.appendChild(dateStamp);
                    createConfetti();
                    checkEasterEgg();
                    updateProgress(); // Fortschritt aktualisieren
                    saveProgress();   // Fortschritt speichern
                }, 500);
            } else if (cell.classList.contains('completed')) {
                cell.classList.remove('completed');
                completedCount--; // Z√§hler verringern
                const dateStamp = cell.querySelector('.date-stamp');
                if (dateStamp) dateStamp.remove();
                updateProgress(); // Fortschritt aktualisieren
                saveProgress();   // Fortschritt speichern
            }
        });
    });

    function exportProgress() {
        const progress = localStorage.getItem('bingoProgress');
        const blob = new Blob([progress], { type: 'application/json' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'bingo-progress.json';
        link.click();
    }

    function importProgress() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'application/json';
        input.addEventListener('change', (event) => {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                const progress = JSON.parse(e.target.result);
                localStorage.setItem('bingoProgress', JSON.stringify(progress));
                location.reload();
            };
            reader.readAsText(file);
        });
        input.click();
    }

    function resetProgress() {
        localStorage.removeItem('bingoProgress');
        location.reload();
    }

    loadProgress();
</script>

</body>
</html>
